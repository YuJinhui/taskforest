<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="TaskForest : A simple, expressive, open-source, text-file-based Job Scheduler with console, HTTP, and RESTful API interfaces.">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>TaskForest</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/aijaz/taskforest">View on GitHub</a>

          <h1 id="project_title">TaskForest</h1>
          <h2 id="project_tagline">A simple, expressive, open-source, text-file-based Job Scheduler with console, HTTP, and RESTful API interfaces.</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/aijaz/taskforest/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/aijaz/taskforest/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a id="taskforest" class="anchor" href="#taskforest" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>TaskForest</h1>

<hr>

<p><a href="https://travis-ci.org/aijaz/taskforest"><img src="https://travis-ci.org/aijaz/taskforest.svg?branch=master" alt="Build Status"></a></p>

<p><strong>TaskForest</strong> is a simple but expressive job scheduler that allows you to
chain jobs/tasks and create time dependencies. It uses text config files to
specify task dependencies.</p>

<h3>
<a id="executive-summary" class="anchor" href="#executive-summary" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Executive Summary</h3>

<p>With the TaskForest Job Scheduler you can:</p>

<ul>
<li>schedule jobs run at predetermined times</li>
<li>have jobs be dependent on each other</li>
<li>rerun failed jobs</li>
<li>mark jobs as succeeded or failed</li>
<li>put jobs on hold and release the holds</li>
<li>release all dependencies on a job</li>
<li>automatically rerun jobs that fail</li>
<li>receive custom emails or SMS when jobs fail, are retried, or succeed</li>
<li>check the status of all jobs scheduled to run today</li>
<li>interact with the included web service using your own client code</li>
<li>interact with the included web server using your default browser</li>
<li>express the relationships between jobs using a simple text-based format (a big advantage if you like using 'grep')</li>
<li>browse job logs using the included web server</li>
</ul>

<h2>
<a id="about" class="anchor" href="#about" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>About</h2>

<h3>
<a id="a-quick-introduction-to-job-schedulers" class="anchor" href="#a-quick-introduction-to-job-schedulers" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>A Quick Introduction to Job Schedulers</h3>

<p>A Job Scheduler is an application that is responsible for scheduling and running programs (also known as jobs or tasks). The user specifies dependencies between jobs, and the job scheduler runs each job only after all its dependencies have been met. Dependencies may be the successful completion of another job (the prerequisite job), or a certain time of day, or ownership of a limited resource or token.</p>

<p>The job scheduler is also responsible for allowing the operator to rerun failed (or even successful) jobs, mark jobs as having succeeded or failed, and querying the status of all the jobs that are scheduled to run.</p>

<p>Collections of jobs that are dependent on each other are known as Families. Some schedulers call Families "Job Streams."</p>

<h3>
<a id="taskforest-design-philosophy" class="anchor" href="#taskforest-design-philosophy" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>TaskForest Design Philosophy</h3>

<p>The TaskForest Job Scheduler is designed with the philosophy that a program should be no more complicated than the minimum amount required to achieve its objectives. Complicated functions can be achieved by a conjunction of simpler functions.</p>

<p>To illustrate this, TaskForest has been designed to run as a single command that, once invoked from the command line, launches any jobs that need to be run, and then sleeps for a bit and then tries again. If you want, the taskforest script can also exit and be run repeatedly. It is a stateless application. You could launch taskforest once a day, and have it run all day, or you could run it once every minute (for example) using cron.</p>

<p>Since TaskForest does not need any graphical interface, it can be run on headless servers that don't have X installed. If you would prefer a graphical interface, it also comes with its own web server so that you can administer the application using any standard web browser. We also provide you a RESTful API that allow you to write your own web clients, so that you can control TaskForest from within your program. Everything you need to do to configure the system can be done by editing text files. </p>

<h3>
<a id="why-text-files-are-a-good-idea" class="anchor" href="#why-text-files-are-a-good-idea" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a name="text_files"></a>Why Text Files are a Good Idea</h3>

<p>One of the initial design requirements of TaskForest was that it be easily configuriable with just a shell prompt and your favorite text editor. Many of the servers I administer are old boxes which I administer by logging into them via ssh. So when it came to designing job dependencies in Family files, I chose a text file representation. The benefits of text files over a graphical user interface for this are many:</p>

<ul>
<li>
<strong>Easy Remote Access</strong> - All you need is the ability to get to a command line and a text editor on the machine that runs taskforest. With the such low client access requirements, virtually any old machine that has internet access and an ssh client can be used to administer the system. I have often worked on our taskforestd server from a local internet cafe using a Putty.exe downloaded minutes earlier.</li>
<li>
<strong>Mobile Access</strong> - Text files also make work relatively easy using a mobile ssh client like Idokorro Mobile SSH. A dedicated mobile client would be ideal, but short of that, the text file approach assures low bandwidth usage and easy-to-make changes.</li>
<li>
<strong>Flexibility</strong> - The simple, easily parseable format of text files allows us to build richer clients later that would use a graphical interface to specify relationships between jobs.</li>
<li>
<strong>Source Control</strong> - The text based format makes it easy to place the Family files under source control. You can also easily diff different versions of the same family file.</li>
<li>
<strong>Grep</strong> - When you have dozens of family files and hundreds of jobs, you may need to answer questions like: "Are we still running Job J1? It needs to be decommissioned." This can easily be answered by grepping the Family files for job J1.</li>
</ul>

<h3>
<a id="comparing-taskforest-to-cron" class="anchor" href="#comparing-taskforest-to-cron" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Comparing TaskForest to cron</h3>

<p>Cron is a very powerful tool, but lacks some important features that most job schedulers perform: It's not easy to specify complex dependencies between jobs. It's also not possible to use cron to rerun jobs or mark jobs as having succeeded so that dependent jobs may run.</p>

<h3>
<a id="taskforest-licensing-and-pricing" class="anchor" href="#taskforest-licensing-and-pricing" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>TaskForest Licensing and Pricing</h3>

<p>TaskForest is distributed free of charge. It's open-source software that's distributed under the Apache License. For details, please read the LICENSE file.</p>

<p>The above does not apply to the files avilable on the website under the <code>/yui</code> url, which is licensed under the <a href="https://github.com/yui/yui3/blob/master/LICENSE.md">BSD License</a>.</p>

<h3>
<a id="system-requirements" class="anchor" href="#system-requirements" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>System Requirements</h3>

<p>TaskForest is written in Perl. It requires Perl 5.8.3 or higher, and the following libraries (available from <a href="http://cpan.org/">CPAN</a>):</p>

<ul>
<li><a href="http://search.cpan.org/search?mode=all&amp;query=DateTime">DateTime</a></li>
<li>
<a href="http://search.cpan.org/search?mode=all&amp;query=Config%3A%3AGeneral">Config::General</a> version 2.38 or higher</li>
<li>
<a href="http://search.cpan.org/search?mode=all&amp;query=Log%3A%3ALog4perl">Log::Log4perl</a> version 1.16 or higher</li>
<li>
<a href="http://search.cpan.org/search?mode=all&amp;query=HTTP%3A%3ADaemon">HTTP::Daemon</a> version 5.818 or higher</li>
<li>
<a href="http://search.cpan.org/search?mode=all&amp;query=HTTP%3A%3AStatus">HTTP::Status</a> version 5.817 or higher</li>
<li>
<a href="http://search.cpan.org/search?mode=all&amp;query=HTTP%3A%3AResponse">HTTP::Response</a> version 5.820 or higher</li>
<li>
<a href="http://search.cpan.org/search?mode=all&amp;query=HTTP%3A%3ARequest">HTTP::Request</a> version 5.818 or higher</li>
<li>
<a href="http://search.cpan.org/search?mode=all&amp;query=Net%3A%3ASMTP">Net::SMTP</a> version 2.31 or higher</li>
</ul>

<p>Most of the testing has been performed on Unix-like operating systems like Linux, FreeBSD, Mac OSX. There has been some testing on Windows, but it is not as exhaustive as that on other operating systems. It is recommended that you run TaskForest on a Unix-like server.</p>

<h3>
<a id="taskforest-support" class="anchor" href="#taskforest-support" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>TaskForest Support</h3>

<p>For support, please visit our website at <a href="http://www.taskforest.com/">http://www.taskforest.com/</a> or
create an issue on GitHub.</p>

<p>If you would like commercial support, please contact me on Twitter at <a href="http://twitter.com/@_aijaz_">@<em>aijaz</em></a> or via email at <code>taskforest</code> <code>@</code> <code>aijaz</code> <code>dot net</code>.</p>

<h3>
<a id="authors" class="anchor" href="#authors" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Authors</h3>

<p><a href="http://aijaz.net/">Aijaz A. Ansari</a></p>

<p>The following developers have graciously contributed patches to enhance TaskForest:</p>

<ul>
<li> Steve Hulet</li>
</ul>

<p>Please see the 'Changes' file for details. If you have contributed code,
and your name is not on the above list, please accept my apologies and
let me know, so that I may give you credit.
If you're using this program, I would love to hear from you. Please contact me on Twitter at @_aijaz_ and let me know.</p>

<h3>
<a id="acknowledgements" class="anchor" href="#acknowledgements" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Acknowledgements</h3>

<p>Many thanks to the following for their help and support:</p>

<ul>
<li>GitHub</li>
<li>Rosco Rouse</li>
<li>Svetlana Lemeshov</li>
<li>Teresia Arthur</li>
<li>Steve Hulet</li>
</ul>

<p>I would also like to thank Randal L. Schwartz for teaching the readers
of the Feb 1999 issue of Web Techniques how to write a pre-forking web
server, the code upon which the TaskForest Web server is built.</p>

<p>I would also like to thank the fine developers at Yahoo! for providing
yui to the open source community.</p>

<h2>
<a id="installing-taskforest" class="anchor" href="#installing-taskforest" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Installing TaskForest</h2>

<p>This program depends on DateTime, for timezone support. You can install DateTime as follows:</p>

<pre><code>perl -MCPAN -e 'install DateTime'
</code></pre>

<p>Similarly, as of version 1.10, it also depends on Config::General and Log::Log4perl. You can install these as follows:</p>

<pre><code>perl -MCPAN -e 'install Config::General'
perl -MCPAN -e 'install Log::Log4perl'
</code></pre>

<p>As of version 1.15, it also depends on the LWP libraries such as HTTP::Daemon, HTTP::Request, etc.</p>

<p>Download the latest TaskForest repository. You can install it the 'normal' way:</p>

<pre><code>cd taskforest
perl Makefile.PL
make
make test
make install
</code></pre>

<p>If you don't have root access, and want to install in a local directory like ~/perl, replace the third line with</p>

<pre><code>perl Makefile.PL prefix=~/perl
</code></pre>

<h2>
<a id="configuring-taskforest" class="anchor" href="#configuring-taskforest" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Configuring TaskForest</h2>

<p>There are two main parts to configuring TaskForest: configuring the Family files that specify job dependencies, and setting the options that determine TaskForest's behavior.</p>

<h3>
<a id="precedence-of-different-options-sources" class="anchor" href="#precedence-of-different-options-sources" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Precedence of Different Options Sources</h3>

<p>All settings (required and optional) may be specified in a variety of ways: command line, environment variable and config file. The order of preferences is this: Most options have default values. Settings specified in the config file override those defaults. Settings specified in environment variables take override those specified in the config file and the default values. Setting specified on the command line override those specified in envrionment variables, and those specified in the config files and the default values.</p>

<p>The names of the environment variable are the same as the names of the settings on the command line (or in the config file), but they should be in UPPER CASE, with <code>TF_</code> prepended. For example, the environment variable name for the <a href="#run_wrapper"><code>run_wrapper</code></a> setting is <code>TF_RUN_WRAPPER</code>.</p>

<h2>
<a id="jobs--families" class="anchor" href="#jobs--families" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Jobs &amp; Families</h2>

<p>A job is defined as any executable program that resides on the file system. It is represented as a file in the files system whose name is the same as the job name. Jobs can depend on each other. Jobs can also have start times before which a job may not by run.</p>

<p>When a job is run by the run wrapper (<code>bin/run_with_log</code>), two status semaphore files are created in the <a href="#log_directory">log directory</a>. The first is created when a job starts and has a name of <code>$FamilyName.$JobName.pid</code>. This file contains some attributes of the job. When the job completes, more attributes are written to this file.</p>

<p>When the job completes, another semaphore file is written to the <a href="#log_directory">log directory</a>. The name of this file will be <code>$FamilyName.$JobName.0</code> if the job ran successfully, and <code>$FamilyName.$JobName.1</code> if the job failed. In either case, the file will contain the exit code of the job (0 in the case of success and non-zero otherwise).</p>

<p>When a job is run by the <code>run_with_log</code> run wrapper, any output the job sends to stdout or stderr will be captured and stored in a file called <code>$FamilyName.$JobName.$pid.$start_time.stdout</code> in the <a href="#log_directory">log directory</a>.</p>

<h2>
<a id="job-status" class="anchor" href="#job-status" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Job Status</h2>

<p>Within TaskForest, every job has a status, which is one of the following values:</p>

<ul>
<li>
<strong>Waiting</strong> - One or more dependencies of the job have not been met.</li>
<li>
<strong>Ready</strong> - All dependencies have been met; the job will run during the next iteration of the <a href="#main_loop">taskforest main loop</a>.</li>
<li>
<strong>Running</strong> - The job is currently running</li>
<li>
<strong>Success</strong> - The job has run successfully</li>
<li>
<strong>Failure</strong> - The job was run, but the program exited with a non-zero return code</li>
</ul>

<h2>
<a id="jobs--families-1" class="anchor" href="#jobs--families-1" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Jobs &amp; Families</h2>

<p>Jobs can be grouped together into <strong>families</strong>. A family has a start time associated with it before which none of its jobs may run. A family also has a either (a) a list of days-of-the-week or (b) a calendar associated with it. Jobs within a family may only run on the days specified by the days-of-the-week or the calendar.</p>

<p>Jobs and families are given simple names. A family is described in a family file whose name is the family name. Each family file is a text file that contains 1 or more job names. The layout of the job names within a family file determine the dependencies between the jobs (if any). There are <a href="#text_files">several reasons why text files are a good choice for Family files</a>.</p>

<p>Family names and job names should contain only the following characters:
ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_</p>

<p>Let's see a few examples. The main script expects environment variables or command line options or configuration file settings that specify the locations of the directory that contain family files, the directory that contains job files, and the directory where the logs will be written. The directory that contains family files should contain only family files.</p>

<h4>
<a id="example-1---family-file-named-f_admin" class="anchor" href="#example-1---family-file-named-f_admin" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>EXAMPLE 1 - Family file named F_ADMIN</h4>

<pre lang="config"><code>start =&gt; '02:00', tz =&gt; 'GMT', days =&gt; 'Mon,Wed,Fri'

 J_ROTATE_LOGS()
</code></pre>

<p>The first line in any family file always contains 3 bits of information about the family: the start time, the time zone, and the days on which this jobs in this family are run, or the calendar that specifies on which dates jobs in this family are run.</p>

<p>In this case, this family starts at 2:00 a.m. Chicago time. The time is adjusted for daylight savings time. This family 'runs' on Monday, Wednesday and Friday only. Pay attention to the format: it's important.</p>

<p>Valid days are 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'. Days must be separated by commas.</p>

<p>All start times (for families and jobs) are in 24-hour format. '00:00' is midnight, '12:00' is noon, '13:00' is 1:00 p.m. and '23:59' is one minute before midnight.</p>

<p>There is only one job in this family - J_ROTATE_LOGS. This family will start at 2:00 a.m., at which time J_ROTATE_LOGS will immediately be run. Note the empty parentheses [()]. These are required.</p>

<p>What does it mean to say that J_ROTATE_LOGS will be run? It means that the system will look for a file called J_ROTATE_LOGS in the directory that contains job files. That file should be executable. The system will execute that file (run that job) and keep track of whether it succeeded or failed. The J_ROTATE_LOGS script can be any executable file: a shell script, a perl script, a C program etc.</p>

<p>To run the program, the system actually runs a wrapper script that invokes the job script. The location of the wrapper script is specified on the command line or in an environment variable.</p>

<p>Now, let's look at a slightly more complicated example:</p>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">TaskForest maintained by <a href="https://github.com/aijaz">aijaz</a></p>
        <p>Published with <a href="https://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
